<!DOCTYPE html>
<html lang="{{ site.lang | default: 'en' }}">

    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        {% if page.url == '/' or page.url == '/index.html' %}
        {% assign seo_title = site.title | append: ' — Robotics, Computer Vision & AI' %}
        {% else %}
        {% assign seo_title = page.title | append: ' · ' | append: site.title %}
        {% endif %}
        <title>{{ seo_title }}</title>
        {% seo title=false %}

        <!-- Google Search Console verification -->
        {% if site.google_site_verification %}
        <meta name="google-site-verification" content="{{ site.google_site_verification }}" />
        {% endif %}

        <!-- Google Analytics 4 (gtag.js) -->
        {% if site.google_analytics %}
        <script async src="https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics }}"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', '{{ site.google_analytics }}');
        </script>
        {% endif %}

        <meta name="robots" content="index, follow" />

                {% assign current_url = page.url | replace: 'index.html', '' %}
                {% assign breadcrumb_name = nil %}
                {% if current_url == '/projects/' %}
                {% assign breadcrumb_name = 'Research' %}
                {% elsif current_url == '/academic/' %}
                {% assign breadcrumb_name = 'Academic' %}
                {% elsif current_url == '/personal/' %}
                {% assign breadcrumb_name = 'Personal' %}
                {% elsif current_url == '/gallery/' %}
                {% assign breadcrumb_name = 'Gallery' %}
                {% elsif current_url == '/print/' %}
                {% assign breadcrumb_name = 'Print' %}
                {% endif %}

                <!-- Structured data: Person -->
                <script type="application/ld+json">
                {
                    "@context": "https://schema.org",
                    "@type": "Person",
                    "@id": "{{ site.url }}/#person",
                    "name": {{ site.author | default: site.title | jsonify }},
                    "url": "{{ site.url }}",
                    "jobTitle": "PhD Student in Robotics, Computer Vision & AI",
                    "affiliation": {
                        "@type": "Organization",
                        "name": "Universidad Miguel Hernández (UMH)"
                    },
                    "sameAs": [
                        "https://www.linkedin.com/in/enheragu",
                        "https://github.com/enheragu",
                        "https://scholar.google.es/citations?user=1J56jsMAAAAJ",
                        "https://orcid.org/0009-0001-7717-1428",
                        "https://www.researchgate.net/profile/Enrique-Heredia-Aguado"
                    ]
                }
                </script>

                <!-- Structured data: WebSite -->
                <script type="application/ld+json">
                {
                    "@context": "https://schema.org",
                    "@type": "WebSite",
                    "@id": "{{ site.url }}/#website",
                    "url": "{{ site.url }}",
                    "name": {{ site.title | jsonify }},
                    "description": {{ site.description | jsonify }},
                    "inLanguage": {{ site.lang | default: 'en' | jsonify }},
                    "publisher": {
                        "@id": "{{ site.url }}/#person"
                    }
                }
                </script>

                <!-- Structured data: WebPage -->
                <script type="application/ld+json">
                {
                    "@context": "https://schema.org",
                    "@type": "WebPage",
                    "@id": "{{ page.url | absolute_url }}#webpage",
                    "url": "{{ page.url | absolute_url }}",
                    "name": {{ page.title | append: ' | ' | append: site.title | jsonify }},
                    "description": {{ page.description | default: site.description | jsonify }},
                    "isPartOf": {
                        "@id": "{{ site.url }}/#website"
                    },
                    "about": {
                        "@id": "{{ site.url }}/#person"
                    },
                    "inLanguage": {{ site.lang | default: 'en' | jsonify }}
                }
                </script>

                <!-- Structured data: BreadcrumbList -->
                <script type="application/ld+json">
                {
                    "@context": "https://schema.org",
                    "@type": "BreadcrumbList",
                    "itemListElement": [
                        {
                            "@type": "ListItem",
                            "position": 1,
                            "name": "CV",
                            "item": "{{ '/' | absolute_url }}"
                        }{% if breadcrumb_name %},
                        {
                            "@type": "ListItem",
                            "position": 2,
                            "name": {{ breadcrumb_name | jsonify }},
                            "item": "{{ current_url | absolute_url }}"
                        }{% endif %}
                    ]
                }
                </script>

        <link id="favicon" rel="shortcut icon" type="image/svg" href={{ "/img/robot.svg" | absolute_url }} />
        <link rel="stylesheet" type="text/css" href={{ "/css/index.css" | absolute_url }} />
        {% for stylesheet in page.custom_css %}
        <link rel="stylesheet" type="text/css" href={{ stylesheet | absolute_url }} />
        {% endfor %}
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    </head>

    <body>
        <!-- Hamburger Navigation -->
        <button class="hamburger-btn" id="hamburgerBtn" aria-label="Menu">
            <span></span><span></span><span></span>
        </button>
        <nav class="nav-menu" id="navMenu">
            <a href="{{ '/' | relative_url }}">CV</a>
            <a href="{{ '/projects/' | relative_url }}">Research</a>
            <a href="{{ '/academic/' | relative_url }}">Academic</a>
            <a href="{{ '/personal/' | relative_url }}">Personal</a>
            <a href="{{ '/gallery/' | relative_url }}">Gallery</a>
        </nav>
        <div class="nav-overlay" id="navOverlay"></div>

        {{ content }}

        <!-- Site-wide footer -->
        {% if page.show_footer != false %}
        <footer class="site-footer">
            <span id="last-update">Last updated: {{ site.time | date: "%-d %B %Y" }}</span>
        </footer>
        {% endif %}

        <!-- Scripts -->
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    {% for jsfile in page.custom_js %}
    <script src={{ jsfile | absolute_url }} ></script>
    {% endfor %}
    <script>
    (function() {
        var btn = document.getElementById('hamburgerBtn');
        var menu = document.getElementById('navMenu');
        var overlay = document.getElementById('navOverlay');
        btn.addEventListener('click', function() {
            menu.classList.toggle('open');
            overlay.classList.toggle('open');
            btn.classList.toggle('open');
        });
        overlay.addEventListener('click', function() {
            menu.classList.remove('open');
            overlay.classList.remove('open');
            btn.classList.remove('open');
        });
        // Highlight current page
        var path = window.location.pathname;
        var links = menu.querySelectorAll('a');
        for (var i = 0; i < links.length; i++) {
            var href = links[i].getAttribute('href');
            if (href === '/') {
                if (path === '/' || path === '/index.html') links[i].classList.add('active');
            } else if (path.indexOf(href.replace(/\/$/, '')) === 0) {
                links[i].classList.add('active');
            }
        }
        // In-page smooth scroll for .mini-nav-scroll links
        document.addEventListener('click', function(e) {
            var link = e.target.closest('.mini-nav-scroll');
            if (!link) return;
            var hash = link.getAttribute('href');
            var target = document.querySelector(hash);
            if (target) {
                e.preventDefault();
                target.scrollIntoView({ behavior: 'smooth', block: 'center' });
                target.style.display = 'block';
                history.replaceState(null, '', hash);
            }
        });
    })();

    // Last-updated: fetch real commit date from GitHub API
    (function() {
        var repo = "{{ site.github_repo }}";
        if (!repo) return;
        fetch("https://api.github.com/repos/" + repo + "/commits?per_page=1")
          .then(function(r) { return r.json(); })
          .then(function(data) {
            if (!data || !data[0] || !data[0].commit) return;
            var d = new Date(data[0].commit.author.date);
            var span = document.getElementById("last-update");
            if (span) span.textContent = "Last updated: " + d.toLocaleDateString("en-GB", { day: "numeric", month: "long", year: "numeric" });
          }).catch(function() {});
    })();
    </script>
    </body>
</html>